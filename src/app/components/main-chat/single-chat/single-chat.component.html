<section
  (mousemove)="showOptionMenu()"
  (mouseleave)="hideOptionMenu()"
  [ngStyle]="{
    'justify-content':
      user.id === userService.userId ? 'flex-end' : 'flex-start'
  }"
>
  <app-options-menu
    [ngClass]="{
      'animation-coming-in': isOptionMenuVisible,
      'animation-coming-out': !isOptionMenuVisible,
      menuRightSide: user.id !== userService.userId,
      menuLeftSide: user.id === userService.userId
    }"
    [user]="user"
    [currentChat]="currentChat"
    (editMsgEmitter)="editMsgEmitter($event)"
    [openOnSecondaryChat]="openOnSecondaryChat"
    [isPrivatChannel]="isPrivatChannel"
  >
    ></app-options-menu
  >

  <div
    class="chatBox"
    [ngStyle]="{
      'flex-direction': user.id === userService.userId ? 'row-reverse' : 'row'
    }"
  >
    <div
      class="userAvatar"
      [ngStyle]="{
        padding: user.id === userService.userId ? '0 0 0 24px' : '0 24px 0 0'
      }"
    >
      <img src="{{ user.avatar }}" alt="" />
    </div>
    @if (!isMsgEditFormOpen) {
    <div
      class="userContent"
      [ngStyle]="{ width: openOnSecondaryChat ? '80%' : 'fit-content' }"
    >
      <div
        class="name"
        [ngStyle]="{
          'flex-direction':
            user.id === userService.userId ? 'row-reverse' : 'row',
        }"
      >
        {{ user.firstName }} {{ user.lastName }}
        <span
          [ngStyle]="{
            padding:
              user.id === userService.userId ? '0 24px 0 0' : '0 0 0 24px'
          }"
          >{{ convertTimestampHour(chat.publishedTimestamp) }}</span
        >
      </div>
      <div
        class="content"
        [ngClass]="{ 'content-mirror': user.id === userService.userId }"
      >
        <div class="msg">
          {{ chat.message }}
          @if (chat.edited) {
          <span>(bearbeitet)</span>
          }
        </div>
        <app-attachments
          [chatId]="chat.id"
          [openOnSecondaryChat]="openOnSecondaryChat"
        ></app-attachments>
      </div>
      @if (!isPrivatChannel) {
      <div class="answers">
        @if (chatService.getChatAnswers(chat.id).length > 0 && showAnswer) {
        <p (click)="openSecondaryChat(chat.id)">
          {{ displayCountChatAnswer() }} Answers
        </p>
        <span>Last answer: {{ displayLastChatAnswer() }}</span>

        } @else if (showAnswer) {
        <p (click)="openSecondaryChat(chat.id)">Answer...</p>
        }
      </div>
      } @else {
      <div class="spacer"></div>
      }
      <app-reaction-emojis
        [chat]="chat"
        [user]="user"
        [openOnSecondaryChat]="openOnSecondaryChat"
      ></app-reaction-emojis>
    </div>

    } @else {
    <div class="editForm">
      <app-edit-msg
        [chat]="chat"
        (closeEditMsgEmitter)="closeEditMsgEmitter($event)"
      ></app-edit-msg>
    </div>
    }
  </div>
</section>
