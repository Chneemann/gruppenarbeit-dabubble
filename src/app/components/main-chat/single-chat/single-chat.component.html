<section (mouseenter)="showOptionMenu()" (mouseleave)="hideOptionMenu()">
  <app-options-menu
    [ngClass]="{
      'animation-coming-in': isOptionMenuVisible,
      'animation-coming-out': !isOptionMenuVisible
    }"
    [index]="index"
    [currentChat]="currentChat"
    (editMsgEmitter)="editMsgEmitter($event)"
    [openOnSecondaryChat]="openOnSecondaryChat"
    [isPrivatChannel]="isPrivatChannel"
  >
    ></app-options-menu
  >

  <div class="userAvatar">
    <img src="{{ user.avatar }}" alt="" />
  </div>
  @if (!isMsgEditFormOpen) {
  <div
    class="userContent"
    [ngClass]="{ mirror: index % 2 !== 0 }"
    [ngStyle]="{ width: openOnSecondaryChat ? '80%' : 'fit-content' }"
  >
    <div class="name">
      {{ user.firstName }} {{ user.lastName }}
      <span>{{ convertTimestampHour(chat.publishedTimestamp) }}</span>
    </div>
    <div class="content">
      <div class="msg">
        {{ chat.message }}
        @if (chat.edited) {
        <span>(bearbeitet)</span>
        }
      </div>
      <app-attachments
        [chatId]="chat.id"
        [openOnSecondaryChat]="openOnSecondaryChat"
      ></app-attachments>
    </div>
    @if (!isPrivatChannel) {
    <div class="answers">
      @if (chatService.getChatAnswers(chat.id).length > 0 && showAnswer) {
      <p (click)="openSecondaryChat(chat.id)">
        {{ displayCountChatAnswer() }} Answers
      </p>
      <span>Last answer: {{ displayLastChatAnswer() }}</span>

      } @else if (showAnswer) {
      <p (click)="openSecondaryChat(chat.id)">Answer...</p>
      }
    </div>
    } @else {
    <div class="spacer"></div>
    }
    <app-reaction-emojis
      [chat]="chat"
      [index]="index"
      [openOnSecondaryChat]="openOnSecondaryChat"
      [mainChatSectionWidth]="mainChatSectionWidth"
    ></app-reaction-emojis>
  </div>
  } @else {
  <div class="editForm" [ngClass]="{ mirror: index % 2 !== 0 }">
    <app-edit-msg
      [chat]="chat"
      (closeEditMsgEmitter)="closeEditMsgEmitter($event)"
    ></app-edit-msg>
  </div>
  }
</section>
