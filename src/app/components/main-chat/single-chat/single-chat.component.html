<section
  (click)="openSecondaryChat(currentChat, $event)"
  (mouseenter)="toggleOptionMenu()"
  (mouseleave)="toggleOptionMenu()"
>
  @if (showOptionsMenu){
  <app-options-menu
    [ngStyle]="{ display: isOptionMenuVisible ? 'block' : 'none' }"
    [index]="index"
    (variableEmitter)="editMsg($event)"
  >
    ></app-options-menu
  >
  }
  <div class="userAvatar">
    <img src="assets/img/user-icons/{{ user.avatar }}.svg" alt="" />
  </div>
  <div class="userContent" [ngClass]="{ mirror: index % 2 !== 0 }">
    <div class="name">
      {{ user.firstName }} {{ user.lastName }}
      <span>{{ convertTimestampHour(chat.publishedTimestamp) }}</span>
    </div>
    <div class="content">
      <div class="msg">
        @if (!isMsgInEdit) {
        {{ chat.message }}
        @if (chat.edited) {
        <span>(bearbeitet)</span>
        } } @else {
        <form
          (ngSubmit)="onSubmit(chat.id, taskForm)"
          #taskForm="ngForm"
          onsubmit="return false"
        >
          <textarea
            type="text"
            id="message"
            name="message"
            minlength="3"
            #message="ngModel"
            [(ngModel)]="chat.message"
            placeholder="{{ chat.message }}"
            >{{ chat.message }}</textarea
          >
          <div class="btns">
            <app-small-btn
              [imgSrc]="'closeIcon.svg'"
              [imgSize]="'15px'"
              [btnSize]="'26px'"
              [btnBgHoverColor]="'#edeefe'"
              (click)="closeEditMsg()"
            >
            </app-small-btn>
            <button type="submit" class="btnSend" [disabled]="message.invalid">
              <img
                src="assets/img/sendIcon.svg"
                alt="Send"
                class="sendIcon"
                [ngClass]="{ disabledIcon: message.invalid }"
              />
            </button>
          </div>
        </form>
        }
      </div>
      <app-attachments [chatId]="chat.id"></app-attachments>
    </div>
    @if (chatService.getChatAnswers(chat.id).length > 0 && showAnswer) {
    <div class="answers">
      <p>{{ displayCountChatAnswer() }} Answers</p>
      <span>Last answer: {{ displayLastChatAnswer() }}</span>
    </div>
    }
  </div>
</section>
