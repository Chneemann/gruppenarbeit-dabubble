<section (mouseleave)="this.isEmojiPickerVisible = false">
  @if (!openOnSecondaryChat) {
  <app-small-btn
    [imgSrc]="'add-reaction.svg'"
    [imgSize]="'24px'"
    [btnSize]="'40px'"
    [btnBgColor]="'#fff'"
    [btnBgHoverColor]="'#edeefe'"
    (click)="toggleEmojiPicker()"
  >
  </app-small-btn>
  } @if(isEmojiPickerVisible) {
  <app-emoji-picker
    [output]="'id'"
    (emojiOutputEmitter)="emojiOutputEmitter($event, chat.id)"
    (emojiVisibleEmitter)="emojiVisibleEmitter($event)"
  ></app-emoji-picker>
  } @for (reaction of getReaction(chat.id); track reaction; let i = $index) {
  @if (reaction.id) {
  <div
    class="emoji"
    (click)="toggleEmoji(reaction.id)"
    (mouseenter)="openDialog(reaction.id)"
    (mouseleave)="closeDialog()"
  >
    @if (reaction.icon === "okay" || reaction.icon === "clap-hands") {
    <img src="./../../../../../assets/img/{{ reaction.icon }}.svg" />
    } @else {
    <ngx-emoji emoji="{{ reaction.icon }}"></ngx-emoji>
    }
    <span>{{ reaction.userId.length }}</span>
  </div>
  }}

  <!-- DIALOG-->

  @if (reactionDialogId != '') { @for (reaction of
  getReactionDocId(reactionDialogId); track reaction) {
  <div
    class="dialog"
    [ngStyle]="{
      'left.px':
        indexOfArray(getReaction(chat.id), reaction) >= 2 && openOnSecondaryChat
          ? (openOnSecondaryChat ? -135 : -85) +
            indexOfArray(getReaction(chat.id), reaction) * 80
          : (openOnSecondaryChat ? 45 : 85) +
            indexOfArray(getReaction(chat.id), reaction) * 80
    }"
    [ngClass]="{
      mirror:
        indexOfArray(getReaction(chat.id), reaction) >= 2 && openOnSecondaryChat
    }"
  >
    <div
      class="icon"
      [ngClass]="{
        mirror:
          indexOfArray(getReaction(chat.id), reaction) >= 2 &&
          openOnSecondaryChat
      }"
    >
      @if (reaction.icon === "okay" || reaction.icon === "clap-hands") {
      <img src="./../../../../../assets/img/{{ reaction.icon }}.svg" />
      } @else {
      <ngx-emoji emoji="{{ reaction.icon }}"></ngx-emoji>
      }
    </div>
    <div
      class="name"
      [ngClass]="{
        mirror:
          indexOfArray(getReaction(chat.id), reaction) >= 2 &&
          openOnSecondaryChat
      }"
    >
      @for (reactionUId of getReactionDocId(reactionDialogId)[0].userId; track
      reactionUId;) {
      <div class="user">
        {{ getUserId(reactionUId)[0].firstName }}
        {{ getUserId(reactionUId)[0].lastName }}
      </div>
      }
    </div>
    @if (getReactionDocId(reactionDialogId)[0].userId.length > 1) {
    <p
      [ngClass]="{
        mirror:
          indexOfArray(getReaction(chat.id), reaction) >= 2 &&
          openOnSecondaryChat
      }"
    >
      haben reagiert.
    </p>
    } @else {
    <p
      [ngClass]="{
        mirror:
          indexOfArray(getReaction(chat.id), reaction) >= 2 &&
          openOnSecondaryChat
      }"
    >
      hat reagiert.
    </p>
    }
  </div>
  } }
</section>
