<section>
  @if (checkCurrentChannel(currentChannel) == 'searchBar') {
  <!-----Searchwindow at the sidebar----->
  <div class="headerSearhcBar">
    <h1>New message</h1>
    <input
      type="text"
      placeholder="To: #channel or @someone"
      [(ngModel)]="chatService.inputValue"
      (keyup)="filterChannelAndUser(chatService.inputValue)"
    />
  </div>
  <div style="margin-top: -24px">
    <app-chat-content
      [getChatChannel]="getChatChannel"
      [getChatUsers]="getChatUsers"
      [getChats]="getChats"
      [getUsers]="getUsers"
      [currentChannel]="currentChannel"
      [hideContentWindow]="false"
    >
    </app-chat-content>
  </div>
  @if (toggleBoolean.openSearchWindow) {
  <!-----search suggestions----->
  <div class="filteredElementWindow">
    @if (firstLetter == '#') { @for (i of channelService.allChannels; track
    $index) {
    <h3 class="user" (click)="chooseElement(i)">#{{ i.name }}</h3>
    } } @else if (firstLetter == '@') { @for (i of userService.allUsers; track
    $index) {
    <div class="user" (click)="chooseElement(i)">
      <div class="positionImgs">
        <img src="{{ i.avatar }}" class="avatarImg" />
        <img
          src="assets/img/{{ i.status ? 'onlineRing.svg' : 'offlineRing.svg' }}"
          class="onlineIconFilterWindow"
        />
      </div>
      <h3>{{ i.firstName }} {{ i.lastName }}</h3>
    </div>
    } }
  </div>
  } } @else { @if(checkCurrentChannel(currentChannel) == 'allPrvChannels'){
  <!------------shwo prv chat----------->
  @for (user of getPrvChat(currentChannel); track user; let i = $index) {
  <div class="headerPrvChat">
    <div class="headlinePrvChat" (click)="openUserProfil()">
      @if (user.talkToUserId == userService.userId) {
      <div class="imgBoxPrvChat">
        <img
          class="imgUserPrvChat"
          src="{{ filterUser(user.creatorId)[i].avatar }}"
        />
        <img
          src="assets/img/{{
            filterUser(user.creatorId)[i].status
              ? 'onlineRing.svg'
              : 'offlineRing.svg'
          }}"
          class="onlineIcon"
        />
      </div>
      <p>
        {{ filterUser(user.creatorId)[i].firstName }}
        {{ filterUser(user.creatorId)[i].lastName }}
      </p>
      } @else {
      <div class="imgBoxPrvChat">
        <img
          class="imgUserPrvChat"
          src="{{ filterUser(user.talkToUserId)[i].avatar }}"
        />
      </div>
      <p>
        {{ filterUser(user.talkToUserId)[i].firstName }}
        {{ filterUser(user.talkToUserId)[i].lastName }}
      </p>
      }
    </div>
  </div>
  <app-chat-content
    [getChatChannel]="getChatChannel"
    [getChatUsers]="getChatUsers"
    [getChats]="getChats"
    [getUsers]="getUsers"
    [currentChannel]="currentChannel"
    [isPrivatChannel]="true"
    [hideContentWindow]="false"
  >
  </app-chat-content>
  } } @else if (checkCurrentChannel(currentChannel) == 'allChannels') {
  <!-------show public channel-chat ----------->
  @for(channel of getChannelName(currentChannel); track channel) {
  <div class="header">
    <div class="headline" (click)="showMenu()">
      <img src="assets/img/hashtag.svg" alt="" />
      <p>{{ channel.name }}</p>
      <img src="assets/img/keyboardArrowDown.svg" alt="" />
    </div>
    <div class="addUserToChannelBox">
      @if (filterChannelForSelectedUser(currentChannel)) {
      <div class="addedUsers" (click)="openMemberWindow(false)">
        @for(user of userService.getFiltertUsers.slice(0, 3) ; track user) {
        <div class="userAvatar">
          <img src="{{ user.avatar }}" alt="" />
        </div>
        }
        <div *ngIf="userService.getFiltertUsers.length > 3" class="dotsImg">
          <img
            *ngFor="let i of [0, 1, 2]"
            src="assets/img/offlineRing.svg"
            alt=""
          />
        </div>
        <h3>{{ userService.getFiltertUsers.length }}</h3>
      </div>
      <app-small-btn
        [imgSrc]="'addPerson.svg'"
        [imgSize]="'20px'"
        [btnSize]="'32px'"
        [btnBgHoverColor]="'#edeefe'"
        (click)="
          viewWidth <= 600 ? openMemberWindow(false) : openMemberWindow(true)
        "
      ></app-small-btn>
      }
    </div>
  </div>
  <app-show-channel-member
    [ngClass]="{
      dBlock: toggleBoolean.openChannelMemberWindow,
      dNone: !toggleBoolean.openChannelMemberWindow
    }"
    [getFiltertUsers]="userService.getFiltertUsers"
    [currentChannel]="currentChannel"
  ></app-show-channel-member>
  <app-chat-content
    [getChatChannel]="getChatChannel"
    [getChatUsers]="getChatUsers"
    [getChats]="getChats"
    [getUsers]="getUsers"
    [currentChannel]="currentChannel"
    [hideContentWindow]="false"
  >
  </app-chat-content>
  }
  <!-- Channel description dialog -->
  <div
    class="menu"
    [ngClass]="{ dBlock: openMenu, dNone: !openMenu }"
    (click)="closeMenu()"
  >
    <div class="whiteBox" (click)="preventCloseWhiteBox($event)">
      @for (channel of getChannelName(currentChannel); track channel) {
      <div class="headerBox">
        <div class="headline">
          <img src="assets/img/hashtag.svg" alt="" />
          <p>{{ channel.name }}</p>
        </div>
        <div class="closeBtn" (click)="closeMenu()">
          <img src="assets/img/closeIcon.svg" alt="" />
        </div>
      </div>
      }
      <div class="contentChannel">
        @for (channel of getChannelName(currentChannel); track channel) {
        <div class="contentHeadline">
          <p>Channel Name</p>
          @if (!openEditNameInput) {
          <span (click)="editChannelName($event)">Edit</span>
          } @else {
          <span (click)="saveEditChannelName($event)">Save Name</span>
          }
        </div>
        @if (!openEditNameInput) {
        <div class="channelName">
          <img src="assets/img/hashtag.svg" alt="" />
          <p>{{ channel.name }}</p>
        </div>
        } @else {
        <div class="channelName">
          <img src="assets/img/hashtag.svg" alt="" />
          <input type="text" [(ngModel)]="nameValue" class="inputName" />
        </div>
        } }
      </div>
      <div class="contentChannel">
        @for (channel of getChannelName(currentChannel); track channel) {

        <div class="contentHeadline">
          <p>Description</p>
          @if (!openEditNameDescription) {
          <span (click)="editChannelDescription($event)">Edit</span>
          } @else {
          <span (click)="saveEditChannelDescription($event)"
            >Save Description</span
          >
          }
        </div>
        @if (!openEditNameDescription) {
        <div class="channelName">
          <p>{{ channel.description }}</p>
        </div>
        } @else {
        <div class="channelName">
          <textarea
            cols="30"
            rows="10"
            [(ngModel)]="descriptionValue"
            class="textareaDescription"
          ></textarea>
        </div>
        }
        <div class="line"></div>
        <div class="contentHeadline">
          <p>Created by</p>
        </div>
        <div class="channelCreator">
          @for (user of getChatUsers(channel.creator); track user) {
          <p>{{ user.firstName }} {{ user.lastName }}</p>
          }
        </div>
        }
      </div>
      <div class="leaveChannel">
        <p (click)="leaveChannel(currentChannel, $event)">Leave channel</p>
      </div>
    </div>
  </div>
  } }
</section>
